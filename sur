@Test
void jwtDecoder_shouldConvertStandardDateClaimsToInstant_andLeaveAuthTimeAsIs() throws Exception {
    Date now = new Date();
    Date exp = new Date(now.getTime() + 60_000);

    // IMPORTANT:
    // Nimbus treats iat/exp/nbf as Date claims.
    // auth_time is often returned as a numeric value, not Date.
    JWTClaimsSet claims = new JWTClaimsSet.Builder()
            .issueTime(now)                 // iat
            .expirationTime(exp)            // exp
            .notBeforeTime(now)             // nbf
            .claim("auth_time", now.getTime() / 1000L) // epoch seconds (common format)
            .claim("sub", "test-user")
            .build();

    String token = new PlainJWT(claims).serialize();
    Jwt decoded = jwtDecoder.decode(token);

    assertNotNull(decoded);

    assertTrue(decoded.getClaims().get("iat") instanceof Instant, "iat should be Instant");
    assertTrue(decoded.getClaims().get("exp") instanceof Instant, "exp should be Instant");
    assertTrue(decoded.getClaims().get("nbf") instanceof Instant, "nbf should be Instant");

    Object authTime = decoded.getClaims().get("auth_time");
    assertTrue(authTime instanceof Number || authTime instanceof Instant,
            "auth_time should be Number (current behavior) or Instant (if decoder improved later)");
}
