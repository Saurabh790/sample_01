/**
 * Copyright (c) Optum 2015 - All Rights Reserved.
 */
package com.optum.fads.web.security.matcher;

import java.util.regex.Pattern;

import org.springframework.security.web.util.matcher.AntPathRequestMatcher;
import org.springframework.security.web.util.matcher.RegexRequestMatcher;
import org.springframework.security.web.util.matcher.RequestMatcher;

public class CsrfSecurityRequestMatcher implements RequestMatcher {

	private final Pattern allowedMethods = Pattern.compile("^(GET|HEAD|TRACE|OPTIONS)$");
	private final RegexRequestMatcher unprotectedMatcher = new RegexRequestMatcher("/login", null);

	private AntPathRequestMatcher[] requestMatchers = { new AntPathRequestMatcher("/login"),
			new AntPathRequestMatcher("/logout"), new AntPathRequestMatcher("/bower_components/**") };

	@Override
	public boolean matches(javax.servlet.http.HttpServletRequest request) {
		if (allowedMethods.matcher(request.getMethod()).matches()) {
			return false;
		}
		for (AntPathRequestMatcher rm : requestMatchers) {
			if (rm.matches(request)) {
				return false;
			}
		}

		return true;
	}

}

[ERROR] /C:/Users/sgupt664/fads-workspace/fads-monolithic-application/fads-monolithic-application/fads-demo-web/src/main/java/com/optum/fads/web/security/matcher/CsrfSecurityRequestMatcher.java:[26,40] incompatible types: javax.servlet.http.HttpServletRequest cannot be converted to jakarta.servlet.http.HttpServletRequest
[ERROR] -> [Help 1]
