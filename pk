SELECT HDR_CLM_TCN, LI_NUM, HDR_CLM_PD_DT,
       HDR_RECIP_ORIG_ID,
       HDR_PAY_TO_PROV_ID,
       HDR_PRESCR_PROV_ID
FROM DM_CLAIM_DRUG_T
WHERE HDR_CLM_TCN = :tcn
  AND LI_NUM = :li_num
  AND HDR_CLM_PD_DT = :hdr_clm_pd_dt;


SELECT HDR_CLM_TCN, LI_NUM, COUNT(*) AS cnt
FROM CA_UNIVERSE_BATCH_T
WHERE CT_BATCH_ID = 451
GROUP BY HDR_CLM_TCN, LI_NUM
HAVING COUNT(*) > 1;
If no rows, then it’s not duplicate → it’s Snowflake mismatch.

2) Pull the batch rows

sql

SELECT HDR_CLM_TCN, LI_NUM, HDR_CLM_PD_DT, CASE_TYPE_CD, PROV_ROLE, PARTICIPANT_ID
FROM CA_UNIVERSE_BATCH_T
WHERE CT_BATCH_ID = 451;
3) Validate each row in Snowflake
For each row, run:

sql


SELECT HDR_CLM_TCN, LI_NUM, HDR_CLM_PD_DT,
       HDR_RECIP_ORIG_ID,
       HDR_PAY_TO_PROV_ID,
       HDR_PRESCR_PROV_ID
FROM DM_CLAIM_DRUG_T
WHERE HDR_CLM_TCN = :tcn
  AND LI_NUM = :li_num
  AND HDR_CLM_PD_DT = :hdr_clm_pd_dt;
Then compare:

MEMBER → PARTICIPANT_ID must match HDR_RECIP_ORIG_ID
PROVIDER/BILLING → must match HDR_PAY_TO_PROV_ID
PROVIDER/PRESCRIBING → must match HDR_PRESCR_PROV_ID
If you want, paste one row from CA_UNIVERSE_BATCH_T (TCN, LI_NUM, HDR_CLM_PD_DT, CASE_TYPE_CD, PROV_ROLE, PARTICIPANT_ID) and I’ll tell you exactly why it turned to N.
