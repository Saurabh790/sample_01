@Test
void jwtDecoder_decodesNimbusJwt_andConvertsDatesToInstant() throws Exception {
    SecurityConfig config = createConfig();
    JwtDecoder decoder = config.jwtDecoder();

    Date iat = new Date(1_000_000L);
    Date exp = new Date(2_000_000L);

    JWTClaimsSet claimsSet = new JWTClaimsSet.Builder()
            .subject("sub-123")
            .claim("groups", List.of("admin"))
            .issueTime(iat)
            .expirationTime(exp)
            .build();

    // FIX: use PlainJWT instead of SignedJWT
    PlainJWT jwtPlain = new PlainJWT(claimsSet);
    String token = jwtPlain.serialize();

    Jwt jwt = decoder.decode(token);

    assertEquals("sub-123", jwt.getSubject());
    assertEquals(List.of("admin"), jwt.getClaimAsStringList("groups"));
    assertEquals(iat.toInstant(), jwt.getIssuedAt());
    assertEquals(exp.toInstant(), jwt.getExpiresAt());
}
