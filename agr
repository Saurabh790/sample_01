package com.optum.fads.authorization.api.entity;

import java.io.Serializable;

import jakarta.persistence.*;
import lombok.Data;

@Entity
@Table(name = "SE_USR_GRP")
@Data
public class SeUsrGrp implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "UI_SYSTEM_ID", unique = true, nullable = false, length = 25)
    private String uiSystemId;

    @ManyToOne
    @JoinColumn(name = "FADS_CASE_GRP_ID", insertable = false, updatable = false)
    private SeCaseGrp seCaseGrp;

    @ManyToOne
    @JoinColumn(name = "FADS_SUR_GRP_ID")
    private SeSurGrp seSurGrp;

    // âœ… ADD THIS: link to FADS group (column must exist in SE_USR_GRP)
    @ManyToOne
    @JoinColumn(name = "FADS_GRP_ID")
    private SeFadsGrp seFadsGrp;

    @OneToOne
    @JoinColumn(name = "UI_SYSTEM_ID", nullable = false, insertable = false, updatable = false)
    private UiUserBase uiUserBase;
}


@Entity
@Table(name = "SE_FADS_GRP")
@Getter @Setter
public class SeFadsGrp {
    @Id
    @Column(name = "FADS_GRP_ID", nullable = false, precision = 5)
    private BigDecimal id;

    @Column(name = "FADS_GRP_NAME", length = 40)
    private String fadsGrpName;
}


// ---------- FADS ROLE (only groupId & groupName) ----------
if (uiUserBase.getSeUsrGrp() != null && uiUserBase.getSeUsrGrp().getSeFadsGrp() != null) {
    var fadsGrp = uiUserBase.getSeUsrGrp().getSeFadsGrp();

    var fadsRole = new com.optum.fads.authorization.api.dto.FadsRole();
    fadsRole.setGroupId(fadsGrp.getId() != null ? fadsGrp.getId().longValue() : null);
    fadsRole.setGroupName(fadsGrp.getFadsGrpName());

    user.getRole().setFadsRole(fadsRole);
}
