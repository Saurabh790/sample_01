server:
  port: 8080
  servlet:
    contextPath: /pgpEngine
quickstart:
  generateOrderPeriod: 10s
  processOrderPeriod: 30s

spring:
  application:
    name: pgp.engine
  cloud:
    azure:
      keyvault:
        secrets:
          endpoint: ${AZURE_KV_URL}
        credential:
          client-id: ${AZURE_KV_CLIENT_ID}
          client-secret: ${AZURE_KV_CLIENT_SECRET}
          tenant-id: ${AZURE_TENANT_ID}

#  jpa:
#    database-platform: com.optum.fads.pgp.jobs.api.config.SnowflakeDialect
#    show-sql: true
  datasource:
    initialize: false
    hikari:
      maximum-pool-size: ${MAXIMUM_DB_POOL_SIZE:50}
      minimum-idle: ${MIN_POOL_IDLE:1}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:60000}
      idle-timeout: ${DB_POOL_IDLE_TIMEOUT:60000}
      leak-detection-threshold: ${LEAK_DETETCTION_THRESHOLD:0}
    sql:
       type: com.zaxxer.hikari.HikariDataSource
       jdbcUrl: ${DB_URL}
       userName: ${DB_USR}
       password: ${DB_PWD}
       driverClassName: com.microsoft.sqlserver.jdbc.SQLServerDriver
       jpa:
           database-platform: org.hibernate.dialect.SQLServer2016Dialect
           database: SQL_SERVER 
           format-sql: true
           globally_quoted_identifiers: true
           show-sql: true
           hibernate:
              use-new-id-generator-mappings: true
              globally_quoted_identifiers: true
              hibernate.allow_update_outside_transaction: true
              naming:
                    implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyHbmImpl
                    physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
    snfk:
      type: com.zaxxer.hikari.HikariDataSource
      driver-class-name: net.snowflake.client.jdbc.SnowflakeDriver
      jdbcUrl: ${SNFK_DB_URL}
      userName: ${SNFK_USR}
      password: ${SNFK_PWD}
      certKey: ${SNFK_CERT_KEY}
      passphrase: ${SNFK_CERT_PASSPHRASE}
      database: ${SNFK_DATABASE}
      schema: ${SNFK_SCHEMA}
      warehouse: ${SNFK_WAREHOUSE}
      role: ${SNFK_ROLE}
      account: ${SNFK_ACCOUNT}
      jpa:
            database-platform: com.optum.fads.pgp.engine.api.config.SnowflakeDialect
            database: default 
            format-sql: true
            globally_quoted_identifiers: true
            show-sql: true
            hibernate:
               use-new-id-generator-mappings: true
               globally_quoted_identifiers: true
               naming:
                     implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyHbmImpl
                     physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
#     properties:
#       hibernate:
#         jdbc:
#           time_zone=UTC
#
#spring:
#  datasource:
#    type: com.zaxxer.hikari.HikariDataSource
#    driver-class-name: org.h2.Driver
#    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1
#    username: sa
#  jpa:
#    hibernate:
#      ddl-auto: create-drop
#    defer-datasource-initialization: true
#    properties:
#      hibernate:
#        dialect: org.hibernate.dialect.H2Dialect
#  h2:
#    console:
#      enabled: true
#      path: /h2
#  sql:
#    init:
#      platform: h2
#      data-locations: classpath:data-h2.sql

  jpa:
    database-platform: org.hibernate.dialect.SQLServer2016Dialect
    database: SQL_SERVER
    #database-platform: com.optum.fads.pgp.jobs.config.SnowflakeDialect
    show-sql: true
    properties:
      hibernate:
        jdbc:
          time_zone: UTC
        show_sql: true

audit:
  application:
    name: pgp.engine
  log:
    type: SECURITY_AUDIT

authority: ${ADF_OAUTH_AUTHZ}
clientId:  ${ADF_CLIENT_ID}
secret:  ${ADF_CLIENT_SECRET}
scope: ${ADF_OAUTH_SCOPE}
pipelineURL: ${ADF_PIPELINE_URL}
paramName: ${ADF_PIPELINE_PARAM}

    
#springdoc:
#  swagger-ui:
#    path: /swagger-ui.html
#  api-docs:
#   path: /openapi/v3/api-docs
#  packagesToScan: com.optum.fads.pgp.engine.api.controller
#  pathsToMatch: /**
app:
  context-path: opi/api/pgp.engine/v1.0/

logging:
  level:
    org:
      hibernate:
        SQL: DEBUG
        type: TRACE
      springframework:
        data:
          jpa:
            repository: DEBUG

    com:
      optum:
        fads: DEBUG
#POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.DataFactory/factories/{factoryName}/pipelines/{pipelineName}/createRun?api-version=2018-06-01
#engine:
#  create-stmt:
#  stats-stmt: BEGIN DBMS_STATS.GATHER_TABLE_STATS (ownname =>     
#logging:
##  file: /tmp/pgp.engine/app/pgp.engine_app.log
#  level:
#  #  root: INFO
#    com.optum.fads: DEBUG
#    org.springframework.orm.jpa: DEBUG
#    org.springframework.data: DEBUG
# #   org.hibernate: DEBUG
#    org.hibernate.sql: debug
#    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
management:
  endpoint:
    metrics.enabled: true
    prometheus.enabled: true
    health:
      probes:
        enabled: true
        add-additional-paths: true
      show-details: always
      cache:
        time-to-live: 10s
#  endpoints.web.exposure.include:
#    - env
#    - health
#    - info
#    - prometheus

  endpoints:
    web:
      exposure:
        include: env,health,info

db:
  snfk-login:
    useCert: ${USE_CERT:false} # Flag to switch between database logins (default or snfk)
