package com.optum.fads.casereminders.api.repo;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

import com.optum.fads.casereminders.api.domain.CaEmailsT;
import com.optum.fads.casereminders.api.domain.CaEmailsTPK;

@Repository
public interface CaEmailsRepository extends  JpaRepository<CaEmailsT, CaEmailsTPK>{
	
//	@Query("select e from CaReminderT e where e.remDt <= sysdate and e.sentFlag ='N'")
	@Query(" FROM CaEmailsT e  where e.emailType = :reminderType and e.remDt <= GETDATE() and e.sentFlag ='N'")
	List<CaEmailsT> findTodaysReminders(@Param("reminderType") String reminderType);
	
	@Query(value = "SELECT  Max(SEQ_NUM+1) FROM CA_EMAILS_T where CASE_ID = :caseId ", nativeQuery = true)
	Integer getNextSequenceId(@Param("caseId") Integer caseId);

}
