 // ============================
    // CODEQL FIX START (helpers)
    // ============================

    /** Map: originalKey -> safeParamName (p0,p1,...) */
    private Map<String, String> buildSafeParamMap(Map<String, String> filterConditions) {
        Map<String, String> safe = new LinkedHashMap<>();
        if (filterConditions == null || filterConditions.isEmpty()) {
            return safe;
        }
        int i = 0;
        for (String key : filterConditions.keySet()) {
            safe.put(key, "p" + i++);
        }
        return safe;
    }

    private void setLikeParam(Query query, String safeParam, String rawValue) {
        // keeps your existing semantics: lower(x) like "%value%"
        query.setString(safeParam, "%" + StringUtils.lowerCase(rawValue) + "%");
    }

    // ============================
    // CODEQL FIX END (helpers)
    // ============================


   public int findAllCaseAssociationsTotalCount(Map<String,String> filterConditions, String[] nodes) {
        StringBuilder sb = new StringBuilder();
        getFindTotalCountQuerySelectFrom(sb);
        sb.append(" where c.caIntelligentKeyTByCaseId.deleteFlag is null  ");

        if (ArrayUtils.isNotEmpty(nodes)) {
            sb.append(" and c.caIntelligentKeyTByCaseId.caLuPrmNodeT.nodeCd IN (:nodeList) ");
        }

        // CODEQL FIX START
        Map<String, String> safeParams = buildSafeParamMap(filterConditions);
        getFindAllQueryFilters(sb, filterConditions, safeParams);
        // CODEQL FIX END

        final String queryString = sb.toString();
        int resultListSize = 0;
        try {
            Query query = getCurrentSession().createQuery(queryString);

            if (ArrayUtils.isNotEmpty(nodes)) {
                query.setParameterList("nodeList", nodes);
            }

            // CODEQL FIX START
            setFindAllQueryFilters(query, filterConditions, safeParams);
            // CODEQL FIX END

            resultListSize = query.list().size();
        } catch (Exception e) {
            log.error("Exception in findAllCaseAssociationsTotalCount: ", e);
            throw e;
        }

        return resultListSize;
    }
