 // ============================
    // CODEQL FIX START (helpers)
    // ============================

    /** Map: originalKey -> safeParamName (p0,p1,...) */
    private Map<String, String> buildSafeParamMap(Map<String, String> filterConditions) {
        Map<String, String> safe = new LinkedHashMap<>();
        if (filterConditions == null || filterConditions.isEmpty()) {
            return safe;
        }
        int i = 0;
        for (String key : filterConditions.keySet()) {
            safe.put(key, "p" + i++);
        }
        return safe;
    }

    private void setLikeParam(Query query, String safeParam, String rawValue) {
        // keeps your existing semantics: lower(x) like "%value%"
        query.setString(safeParam, "%" + StringUtils.lowerCase(rawValue) + "%");
    }

    // ============================
    // CODEQL FIX END (helpers)
    // ============================
