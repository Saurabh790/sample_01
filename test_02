  @Override
    public int findCasesForAssociationsTotalCount(Map<String,String> filterConditions, Integer caseId, String[] nodes) {
        StringBuilder sb = new StringBuilder();
        getFindCasesForAssocTotalCountQuerySelectFrom(sb);
        sb.append(" where  c.deleteFlag is null   ");

        if (ArrayUtils.isNotEmpty(nodes)) {
            sb.append(" and c.caLuPrmNodeT.nodeCd IN (:nodeList) ");
        }

        sb.append(" and ( c.caseId <> :cid");
        sb.append(" )");

        // CODEQL FIX START
        Map<String, String> safeParams = buildSafeParamMap(filterConditions);
        getCasesForAssocQueryFilters(sb, filterConditions, safeParams);
        // CODEQL FIX END

        sb.append(" ) ");
        final String queryString = sb.toString();

        int resultListSize = 0;
        try {
            Query query = getCurrentSession().createQuery(queryString);

            if (ArrayUtils.isNotEmpty(nodes)) {
                query.setParameterList("nodeList", nodes);
            }

            query.setInteger("cid", caseId);

            // CODEQL FIX START
            setCasesForAssocQueryFilters(query, filterConditions, safeParams);
            // CODEQL FIX END

            final Long longVal = (Long) query.uniqueResult();
            resultListSize = longVal.intValue();

        } catch (Exception e) {
            log.error("Exception in findCasesForAssociationsTotalCount: ", e);
            throw e;
        }

        return resultListSize;
    }
