  public List<AssociationListItem> findCasesForAssociations(Map<String, String> filterConditions,
                                                             Map<String, String> sortConditions,
                                                             final int firstRecord, final int maxRecords,
                                                             Integer caseId, String[] nodes) {
        StringBuilder sb = new StringBuilder();
        getFindCasesForAssocQuerySelectFrom(sb);

        sb.append(" where c.deleteFlag is null   ");

        if (ArrayUtils.isNotEmpty(nodes)) {
            sb.append(" and c.caLuPrmNodeT.nodeCd IN (:nodeList) ");
        }

        sb.append(" and ( c.caseId <> :cid");
        sb.append(" )");

        // CODEQL FIX START
        Map<String, String> safeParams = buildSafeParamMap(filterConditions);
        getCasesForAssocQueryFilters(sb, filterConditions, safeParams);
        // CODEQL FIX END

        getCasesForAssocQueryOrderBy(sb, sortConditions);

        final String queryString = sb.toString();
        List<AssociationListItem> resultList = new ArrayList<>();
        try {
            Query query = getCurrentSession().createQuery(queryString);

            if (ArrayUtils.isNotEmpty(nodes)) {
                query.setParameterList("nodeList", nodes);
            }

            query.setInteger("cid", caseId);

            // CODEQL FIX START
            setCasesForAssocQueryFilters(query, filterConditions, safeParams);
            // CODEQL FIX END

            query.setResultTransformer(Transformers.aliasToBean(AssociationListItem.class));
            query.setFirstResult(firstRecord);
            query.setMaxResults(maxRecords);

            resultList = query.list();

        } catch (Exception e) {
            log.error("Exception in findCasesForAssociations: ", e);
            throw e;
        }

        return resultList;
    }
