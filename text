@GetMapping("/findAllByPageable")
public UserListResponse getUsers(
        @RequestParam(defaultValue = "1") int pageNumber,
        @RequestParam(defaultValue = "10") int recordsPerPage,
        @RequestParam(defaultValue = DEFAULT_SORT_FIELD) String sortBy,
        @RequestParam(defaultValue = "1") int sortOrder,
        @RequestParam(required = false) String searchBy,
        @RequestParam(required = false) String searchInput) {

    String entitySortField = mapToEntityField(sortBy);

    Sort.Direction direction = (sortOrder == -1) ? Sort.Direction.DESC : Sort.Direction.ASC;
    Sort sort = Sort.by(direction, entitySortField);

    // âœ… FIX FOR CODEQL: sanitize user input before arithmetic
    int safePageNumber = (pageNumber < 1) ? 1 : pageNumber;
    int safeRecords = (recordsPerPage < 1) ? 10 : recordsPerPage;

    Pageable pageable = PageRequest.of(safePageNumber - 1, safeRecords, sort);

    return userListService.getAllUsers(pageable, searchBy, searchInput);
}



