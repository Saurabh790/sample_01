@Repository
@Transactional(readOnly = true)
public class UserDaoImpl implements UserDao {

    @PersistenceContext
    private EntityManager em;

    @Override
    public List<UserListItem> getUserList() {
        String jpql = """
            SELECT new com.optum.fads.userroles.api.dto.UserListItem(
                u.uiSystemId,
                u.uiUserId,
                u.uiLastName,
                u.uiFirstName,
                u.uiTitle,
                u.uiEMailAddress,
                fg.fadsGrpName,
                sg.surGrpName,
                cg.caseGrpName
            )
            FROM UiUserBase u
            JOIN u.seUsrGrp ug
            LEFT JOIN ug.fadsGrp fg
            LEFT JOIN ug.fadsSurGrp sg
            LEFT JOIN ug.fadsCaseGrp cg
            """;

        return em.createQuery(jpql, UserListItem.class).getResultList();
    }
}
