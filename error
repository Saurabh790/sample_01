/*
//***********************************************
// Copyright UNITEDHEALTH GROUP CORPORATION 2018.
// This software and documentation contain confidential and
// proprietary information owned by UnitedHealth Group Corporation.
// Unauthorized use and distribution are prohibited.
//***********************************************
*/

package com.optum.fads.caseentrybatch.api.config;

import org.modelmapper.ModelMapper;
import org.modelmapper.convention.MatchingStrategies;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Scope;

import static org.springframework.beans.factory.config.ConfigurableBeanFactory.SCOPE_PROTOTYPE;

/**
 * The CommonConfig holds spring based configuration
 */
@Configuration
public class CommonConfig {

    /**
     * Model Mapper for mapping objects
     *
     * @return modelMapper
     */
    @Bean
    @Scope(SCOPE_PROTOTYPE)
    public ModelMapper modelMapper() {
        final var modelMapper = new ModelMapper();
        modelMapper.getConfiguration().setAmbiguityIgnored(true);
        modelMapper.getConfiguration().setMatchingStrategy(MatchingStrategies.STRICT);
        return modelMapper;
    }
}
package com.optum.fads.caseentrybatch.api.config;

import java.io.IOException;
import java.util.HashMap;
import java.util.Properties;
import jakarta.persistence.EntityManagerFactory;
import javax.sql.DataSource;
import org.bouncycastle.pkcs.PKCSException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

/**
 * @author sbajaj8
 *
 */
@Configuration
@EnableAutoConfiguration(exclude={DataSourceAutoConfiguration.class})
@EnableTransactionManagement
@EnableJpaRepositories(entityManagerFactoryRef = "snfkEntityManagerFactory",
						transactionManagerRef = "txManagerSnFk",
						basePackages = {"com.optum.fads.caseentrybatch.api.snowflakeRepo"}
						)
public class ServiceConfig 
{
	
	@Value("${spring.datasource.snfk.jdbcUrl}")
    private String url;

    @Value("${spring.datasource.snfk.userName}")
    private String username;

    @Value("${spring.datasource.snfk.password}")
    private String password;

    @Value("${spring.datasource.snfk.database}")
    private String database;

    @Value("${spring.datasource.snfk.schema}")
    private String schema;

    @Value("${spring.datasource.snfk.warehouse}")
    private String warehouse;

    @Value("${spring.datasource.snfk.account}")
    private String account;
    
    @Value("${spring.datasource.snfk.role}")
    private String role;
	
    @Primary
	@Bean(name="fadsDataSource")
    @ConfigurationProperties("spring.datasource.snfk")
    public DataSource customDataSource() throws Exception, IOException {
        Properties props = new Properties();
        props.put("user", username);
        props.put("password", password);
        props.put("database", database);
        props.put("schema", schema);
        props.put("warehouse", warehouse);
        props.put("role", role);
        props.put("account", account);
        return new DriverManagerDataSource(url, props);

    }
	
    @Primary
	@Bean("snfkEntityManagerFactory")
    public LocalContainerEntityManagerFactoryBean 
    snfkEntityManagerFactory( ) throws IOException, PKCSException, Exception
	 {
	  LocalContainerEntityManagerFactoryBean em
	          = new LocalContainerEntityManagerFactoryBean();
	        em.setDataSource(customDataSource());
	        em.setPackagesToScan(
	          new String[] { "com.optum.fads.caseentrybatch.api.snowflakeDomain" });
	        HibernateJpaVendorAdapter vendorAdapter
	          = new HibernateJpaVendorAdapter();
	        em.setJpaVendorAdapter(vendorAdapter);
	        HashMap<String, Object> properties = new HashMap<>();
	        properties.put("hibernate.allow_update_outside_transaction",true);
	        properties.put("hibernate.dialect", "com.optum.fads.caseentrybatch.api.config.SnowflakeDialect");
	        em.setJpaPropertyMap(properties);
	    return em;
	}
	
    @Primary
	@Bean ("txManagerSnFk")
	
	public PlatformTransactionManager txManagerSnFk(@Qualifier("snfkEntityManagerFactory")EntityManagerFactory snfkEntityManagerFactory) throws IOException, PKCSException, Exception
	 {
    	JpaTransactionManager txManager = new JpaTransactionManager();
        txManager.setEntityManagerFactory(snfkEntityManagerFactory().getObject());
        return txManager;
	 }

    @Bean(name = "jdbcSnowflake")
    
    public JdbcTemplate snowflakeJdbcTemplate(@Qualifier("fadsDataSource") DataSource dsSlave) {
        return new JdbcTemplate(dsSlave);
    }
	}


	

package com.optum.fads.caseentrybatch.api.config;

import javax.sql.DataSource;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import jakarta.persistence.EntityManagerFactory;

/**
 * @author sbajaj8
 *
 */
@Configuration
@EnableAutoConfiguration(exclude={DataSourceAutoConfiguration.class})
@EnableTransactionManagement
@EnableJpaRepositories(entityManagerFactoryRef = "sqlEntityManagerFactory",
						transactionManagerRef = "txManagerSQL",
						basePackages = "com.optum.fads.caseentrybatch.api.repo" )
		public class ServiceConfigSQL 
		{
			@Bean(name = "fadsSQLDataSource")
			@ConfigurationProperties("spring.datasource.sql") 
				public DataSource fadsSQLDataSource() {
					return DataSourceBuilder.create().build(); 
			}
	
			@Bean(name = "sqlEntityManagerFactory")
				public LocalContainerEntityManagerFactoryBean sqlEntityManagerFactory()
					{
						LocalContainerEntityManagerFactoryBean em
								= new LocalContainerEntityManagerFactoryBean();
						em.setDataSource(fadsSQLDataSource());
						em.setPackagesToScan(
								new String[] { "com.optum.fads.caseentrybatch.api.domain" });
						HibernateJpaVendorAdapter vendorAdapter
							= new HibernateJpaVendorAdapter();
						em.setJpaVendorAdapter(vendorAdapter);
					return em;
					}
	 
	 
	 @Bean(name = "txManagerSQL")
	 public PlatformTransactionManager txManagerSQL(@Qualifier("sqlEntityManagerFactory")EntityManagerFactory sqlEntityManagerFactory)
	 {
		 JpaTransactionManager txManager = new JpaTransactionManager();
	        txManager.setEntityManagerFactory(sqlEntityManagerFactory().getObject());
	        return txManager;
	 }
	 
	}


	

server:
  port: 8080
  servlet:
    contextPath: /caseentrybatch
quickstart:
  generateOrderPeriod: 10s
  processOrderPeriod: 30s

spring: 
  application:
   name: caseentrybatch
  jpa:
    database-platform: com.optum.fads.caseentrybatch.api.config.SnowflakeDialect
    
  datasource:
     hikari:
      maximum-pool-size: ${MAXIMUM_DB_POOL_SIZE:50}
      minimum-idle: ${MIN_POOL_IDLE:1}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:60000}
      idle-timeout: ${DB_POOL_IDLE_TIMEOUT:60000}
      leak-detection-threshold: ${LEAK_DETETCTION_THRESHOLD:0}
     sql:
       type: com.zaxxer.hikari.HikariDataSource
       jdbcUrl: jdbc:sqlserver://wn000054716:1433;databaseName=fadsdb;encrypt=true;trustServerCertificate=true;
       userName: fads_dev
       password: qAut9fM.S!g3?385
       driverClassName: com.microsoft.sqlserver.jdbc.SQLServerDriver
       jpa:
           database-platform: org.hibernate.dialect.SQLServer2016Dialect
           database: SQL_SERVER 
           format-sql: true
           globally_quoted_identifiers: true
           show-sql: true
           hibernate:
              use-new-id-generator-mappings: true
              globally_quoted_identifiers: true
              hibernate.allow_update_outside_transaction: true
              naming:
                    implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyHbmImpl
                    physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
     snfk:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: net.snowflake.client.jdbc.SnowflakeDriver
        jdbcUrl: jdbc:snowflake://ew98463.east-us-2.azure.snowflakecomputing.com:443/?TIMEZONE=UTC&CLIENT_RESULT_COLUMN_CASE_INSENSITIVE=true
        database: PI_DEMO_DB
        userName: pi-sf-usr-dev
        password: pi-sf-usr-dev-pw
        certKey: pi-sf-key-dev
        passphrase: pi-sf-key-dev-pw
        schema: FADS
        warehouse: SGS_PI_DEMO_XSMALL_WH
        role: 
        account: 
        jpa:
            database-platform: com.optum.fads.caseentrybatch.api.config.SnowflakeDialect
            database: default 
            format-sql: true
            globally_quoted_identifiers: true
            show-sql: true
            hibernate:
               use-new-id-generator-mappings: true
               globally_quoted_identifiers: true
               naming:
                     implicit-strategy: org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyHbmImpl
                     physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
  quartz:
    properties:
      org:
        quartz:
          threadPool:
            class: org.quartz.simpl.SimpleThreadPool
            threadCount: 3      
management:
  endpoint:
    metrics.enabled: true
    prometheus.enabled: true
  endpoints.web.exposure.include:
    - health
    - info
    - prometheus
  prometheus.metrics.export.enabled: true
#  security:
#    oauth2:
#      resourceserver:
#        jwt:
#          jwk-set-uri: ${JWKS_URL}
#logging:
#  level:
#    org:
#      hibernate:
#        SQL: DEBUG
#        type: TRACE
db:
  snfk-login:
    useCert: ${USE_CERT:false}



[INFO] <<< spring-boot:3.5.8:run (default-cli) < test-compile @ fads-case-entry-batch <<<
[INFO]
[WARNING] The artifact org.hibernate:hibernate-core:jar:6.2.3.Final has been relocated to org.hibernate.orm:hibernate-core:jar:6.2.3.Final
[INFO]
[INFO] --- spring-boot:3.5.8:run (default-cli) @ fads-case-entry-batch ---
[INFO] Attaching agents: []
11:31:33,617 |-WARN in ch.qos.logback.classic.boolex.StubEventEvaluator@324c64cd - This class is a stub for JaninoEventEvaluator which was removed in logback version 1.5.13
11:31:33,619 |-WARN in ch.qos.logback.classic.boolex.StubEventEvaluator@324c64cd - You can migrate existing configurations to Java-only equivalents with the "Janino Expression migrator" tool at:
11:31:33,619 |-WARN in ch.qos.logback.classic.boolex.StubEventEvaluator@324c64cd - https://logback.qos.ch/translator/services/janinoExpressionMigrator.html

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.8)

2026-02-06T11:31:33.976+05:30  INFO 19436 --- [           main] c.o.f.c.api.CaseEntryBatchApplication    : Starting CaseEntryBatchApplication using Java 17.0.10 with PID 19436 (C:\Users\sgupt664\BE_Projects\fads-case-entry-batch\target\classes started by sgupt664 in C:\Users\sgupt664\BE_Projects\fads-case-entry-batch)
2026-02-06T11:31:33.986+05:30  INFO 19436 --- [           main] c.o.f.c.api.CaseEntryBatchApplication    : No active profile set, falling back to 1 default profile: "default"
2026-02-06T11:31:34.987+05:30  INFO 19436 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-02-06T11:31:35.178+05:30  INFO 19436 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 179 ms. Found 3 JPA repository interfaces.
2026-02-06T11:31:35.181+05:30  INFO 19436 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-02-06T11:31:35.469+05:30  INFO 19436 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 283 ms. Found 30 JPA repository interfaces.
2026-02-06T11:31:36.309+05:30  INFO 19436 --- [           main] ptablePropertiesBeanFactoryPostProcessor : Post-processing PropertySource instances
2026-02-06T11:31:36.311+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Skipping PropertySource configurationProperties [class org.springframework.boot.context.properties.source.ConfigurationPropertySourcesPropertySource
2026-02-06T11:31:36.312+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Skipping PropertySource servletConfigInitParams [class org.springframework.core.env.PropertySource$StubPropertySource
2026-02-06T11:31:36.314+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Skipping PropertySource servletContextInitParams [class org.springframework.core.env.PropertySource$StubPropertySource
2026-02-06T11:31:36.315+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource systemProperties [org.springframework.core.env.PropertiesPropertySource] to EncryptableMapPropertySourceWrapper
2026-02-06T11:31:36.317+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource systemEnvironment [org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor$OriginAwareSystemEnvironmentPropertySource] to EncryptableSystemEnvironmentPropertySourceWrapper
2026-02-06T11:31:36.317+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource random [org.springframework.boot.env.RandomValuePropertySource] to EncryptablePropertySourceWrapper
2026-02-06T11:31:36.318+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource Config resource 'class path resource [application.yml]' via location 'optional:classpath:/' [org.springframework.boot.env.OriginTrackedMapPropertySource] to EncryptableMapPropertySourceWrapper
2026-02-06T11:31:36.318+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource applicationInfo [org.springframework.boot.ApplicationInfoPropertySource] to EncryptableMapPropertySourceWrapper
2026-02-06T11:31:36.575+05:30  INFO 19436 --- [           main] c.u.j.filter.DefaultLazyPropertyFilter   : Property Filter custom Bean not found with name 'encryptablePropertyFilter'. Initializing Default Property Filter
2026-02-06T11:31:36.590+05:30  INFO 19436 --- [           main] c.u.j.r.DefaultLazyPropertyResolver      : Property Resolver custom Bean not found with name 'encryptablePropertyResolver'. Initializing Default Property Resolver
2026-02-06T11:31:36.606+05:30  INFO 19436 --- [           main] c.u.j.d.DefaultLazyPropertyDetector      : Property Detector custom Bean not found with name 'encryptablePropertyDetector'. Initializing Default Property Detector
2026-02-06T11:31:36.960+05:30  INFO 19436 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-02-06T11:31:36.974+05:30  INFO 19436 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-02-06T11:31:36.975+05:30  INFO 19436 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-02-06T11:31:37.096+05:30  INFO 19436 --- [           main] o.a.c.c.C.[.[.[/caseentrybatch]          : Initializing Spring embedded WebApplicationContext
2026-02-06T11:31:37.099+05:30  INFO 19436 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3051 ms
2026-02-06T11:31:37.644+05:30  INFO 19436 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-02-06T11:31:37.711+05:30  INFO 19436 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.3.Final
2026-02-06T11:31:37.717+05:30  INFO 19436 --- [           main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2026-02-06T11:31:38.105+05:30  INFO 19436 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2026-02-06T11:31:38.251+05:30  INFO 19436 --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-02-06T11:31:38.335+05:30  WARN 19436 --- [           main] o.h.e.j.e.i.JdbcEnvironmentInitiator     : HHH000342: Could not obtain connection to query metadata

net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:316)
        at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:152)
        at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:34)
        at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:119)
        at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:264)
        at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:239)
        at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:216)
        at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
        at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:230)
        at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:198)
        at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:166)
        at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1380)
        at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1451)
        at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:973)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
        at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
        at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
        at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
        at com.optum.fads.caseentrybatch.api.CaseEntryBatchApplication.main(CaseEntryBatchApplication.java:29)

2026-02-06T11:31:38.614+05:30  INFO 19436 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2026-02-06T11:31:39.574+05:30  INFO 19436 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2026-02-06T11:31:39.577+05:30  INFO 19436 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-02-06T11:31:39.609+05:30  INFO 19436 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-02-06T11:31:39.798+05:30  INFO 19436 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2026-02-06T11:31:39.798+05:30  INFO 19436 --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-02-06T11:31:39.800+05:30  INFO 19436 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-02-06T11:31:40.104+05:30  INFO 19436 --- [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 458d3e96-c926-46df-8ecf-849d7e80a155
2026-02-06T11:31:40.105+05:30  INFO 19436 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-02-06T11:31:40.466+05:30  INFO 19436 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2026-02-06T11:31:41.259+05:30  INFO 19436 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2026-02-06T11:31:41.261+05:30  INFO 19436 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-02-06T11:31:41.576+05:30  INFO 19436 --- [           main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-02-06T11:31:42.786+05:30  INFO 19436 --- [           main] c.o.f.c.a.c.CaseEntryBatchJobConfig      : casebatchJobTrigger set up with Cron Expression 0 0/1 * ? * *
2026-02-06T11:31:43.056+05:30  WARN 19436 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-02-06T11:31:43.621+05:30  INFO 19436 --- [           main] c.a.c.h.n.implementation.NettyUtility    : {"az.sdk.message":"The following Netty versions were found on the classpath and have a mismatch with the versions used by azure-core-http-netty. If your application runs without issue this message can be ignored, otherwise please align the Netty versions used in your application. For more information, see https://aka.ms/azsdk/java/dependency/troubleshoot.","azure-netty-version":"4.1.127.Final","azure-netty-native-version":"2.0.74.Final","classpath-netty-version-io.netty:netty-common":"4.1.118.Final","classpath-netty-version-io.netty:netty-handler":"4.1.128.Final","classpath-netty-version-io.netty:netty-handler-proxy":"4.1.128.Final","classpath-netty-version-io.netty:netty-buffer":"4.1.118.Final","classpath-netty-version-io.netty:netty-codec":"4.1.128.Final","classpath-netty-version-io.netty:netty-codec-http":"4.1.129.Final","classpath-netty-version-io.netty:netty-codec-http2":"4.1.129.Final","classpath-netty-version-io.netty:netty-transport-native-unix-common":"4.1.128.Final","classpath-netty-version-io.netty:netty-transport-native-epoll":"4.1.110.Final","classpath-netty-version-io.netty:netty-transport-native-kqueue":"4.1.128.Final","classpath-native-netty-version-io.netty:netty-tcnative-boringssl-static":"2.0.74.Final"}
2026-02-06T11:31:44.057+05:30  INFO 19436 --- [           main] org.quartz.impl.StdSchedulerFactory      : Using default implementation for ThreadExecutor
2026-02-06T11:31:44.072+05:30  INFO 19436 --- [           main] org.quartz.core.SchedulerSignalerImpl    : Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2026-02-06T11:31:44.072+05:30  INFO 19436 --- [           main] org.quartz.core.QuartzScheduler          : Quartz Scheduler v2.5.1 created.
2026-02-06T11:31:44.074+05:30  INFO 19436 --- [           main] org.quartz.simpl.RAMJobStore             : RAMJobStore initialized.
2026-02-06T11:31:44.075+05:30  INFO 19436 --- [           main] org.quartz.core.QuartzScheduler          : Scheduler meta-data: Quartz Scheduler (v2.5.1) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 3 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2026-02-06T11:31:44.075+05:30  INFO 19436 --- [           main] org.quartz.impl.StdSchedulerFactory      : Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
2026-02-06T11:31:44.075+05:30  INFO 19436 --- [           main] org.quartz.impl.StdSchedulerFactory      : Quartz scheduler version: 2.5.1
2026-02-06T11:31:44.075+05:30  INFO 19436 --- [           main] org.quartz.core.QuartzScheduler          : JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@472bc0b7
2026-02-06T11:31:44.121+05:30  INFO 19436 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 3 endpoints beneath base path '/actuator'
2026-02-06T11:31:44.250+05:30  INFO 19436 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/caseentrybatch'
2026-02-06T11:31:44.253+05:30  INFO 19436 --- [           main] u.j.c.RefreshScopeRefreshedEventListener : Refreshing cached encryptable property sources on ServletWebServerInitializedEvent
2026-02-06T11:31:44.253+05:30  INFO 19436 --- [           main] CachingDelegateEncryptablePropertySource : Property Source systemProperties refreshed
2026-02-06T11:31:44.253+05:30  INFO 19436 --- [           main] CachingDelegateEncryptablePropertySource : Property Source systemEnvironment refreshed
2026-02-06T11:31:44.253+05:30  INFO 19436 --- [           main] CachingDelegateEncryptablePropertySource : Property Source random refreshed
2026-02-06T11:31:44.253+05:30  INFO 19436 --- [           main] CachingDelegateEncryptablePropertySource : Property Source Config resource 'class path resource [application.yml]' via location 'optional:classpath:/' refreshed
2026-02-06T11:31:44.255+05:30  INFO 19436 --- [           main] CachingDelegateEncryptablePropertySource : Property Source applicationInfo refreshed
2026-02-06T11:31:44.255+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Skipping PropertySource configurationProperties [class org.springframework.boot.context.properties.source.ConfigurationPropertySourcesPropertySource
2026-02-06T11:31:44.255+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Skipping PropertySource servletConfigInitParams [class org.springframework.core.env.PropertySource$StubPropertySource
2026-02-06T11:31:44.256+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource servletContextInitParams [org.springframework.web.context.support.ServletContextPropertySource] to EncryptableEnumerablePropertySourceWrapper
2026-02-06T11:31:44.256+05:30  INFO 19436 --- [           main] c.u.j.EncryptablePropertySourceConverter : Converting PropertySource Management Server [org.springframework.boot.actuate.autoconfigure.web.server.ManagementContextAutoConfiguration$LocalManagementPortPropertySource] to EncryptableEnumerablePropertySourceWrapper
2026-02-06T11:31:44.259+05:30  INFO 19436 --- [           main] o.s.s.quartz.SchedulerFactoryBean        : Starting Quartz Scheduler now
2026-02-06T11:31:44.260+05:30  INFO 19436 --- [           main] org.quartz.core.QuartzScheduler          : Scheduler quartzScheduler_$_NON_CLUSTERED started.
2026-02-06T11:31:44.278+05:30  INFO 19436 --- [           main] c.o.f.c.api.CaseEntryBatchApplication    : Started CaseEntryBatchApplication in 11.445 seconds (process running for 12.046)
2026-02-06T11:32:00.021+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job is starting...
2026-02-06T11:32:00.022+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  :  Run Case Batch
2026-02-06T11:32:00.054+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 35
2026-02-06T11:32:00.246+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 35
2026-02-06T11:32:00.282+05:30  WARN 19436 --- [eduler_Worker-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:32:00.283+05:30 ERROR 19436 --- [eduler_Worker-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:32:00.292+05:30 ERROR 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 35
2026-02-06T11:32:00.293+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:32:00.293+05:30 ERROR 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:32:00.381+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:32:00.540+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:32:00.581+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:32:00.585+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:32:00.585+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:32:01.214+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:32:01.269+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:32:01.270+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:32:01.298+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:32:01.299+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:32:01.299+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:32:01.383+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:32:01.394+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:32:01.395+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 36
2026-02-06T11:32:01.583+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 36
2026-02-06T11:32:01.595+05:30  WARN 19436 --- [eduler_Worker-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:32:01.595+05:30 ERROR 19436 --- [eduler_Worker-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:32:01.595+05:30 ERROR 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 36
2026-02-06T11:32:01.596+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:32:01.596+05:30 ERROR 19436 --- [eduler_Worker-1] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:32:01.628+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:32:01.630+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:32:01.656+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:32:01.659+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:32:01.659+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:32:01.873+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:32:01.880+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:32:01.880+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:32:01.895+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:32:01.896+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:32:01.896+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:32:02.868+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:32:02.877+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:32:02.877+05:30  INFO 19436 --- [eduler_Worker-1] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job end...
2026-02-06T11:33:00.001+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job is starting...
2026-02-06T11:33:00.003+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  :  Run Case Batch
2026-02-06T11:33:00.023+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 35
2026-02-06T11:33:00.064+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 35
2026-02-06T11:33:00.070+05:30  WARN 19436 --- [eduler_Worker-2] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:33:00.071+05:30 ERROR 19436 --- [eduler_Worker-2] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:33:00.071+05:30 ERROR 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 35
2026-02-06T11:33:00.071+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:33:00.071+05:30 ERROR 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:33:00.093+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:33:00.095+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:33:00.111+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:33:00.113+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:33:00.113+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:33:00.307+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:33:00.336+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:33:00.336+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:33:00.388+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:33:00.388+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:33:00.388+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:33:00.573+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:33:00.584+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:33:00.584+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 36
2026-02-06T11:33:00.722+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 36
2026-02-06T11:33:00.729+05:30  WARN 19436 --- [eduler_Worker-2] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:33:00.729+05:30 ERROR 19436 --- [eduler_Worker-2] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:33:00.730+05:30 ERROR 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 36
2026-02-06T11:33:00.730+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:33:00.730+05:30 ERROR 19436 --- [eduler_Worker-2] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:33:00.746+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:33:00.748+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:33:00.765+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:33:00.765+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:33:00.765+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:33:01.038+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:33:01.045+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:33:01.046+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:33:01.066+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:33:01.066+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:33:01.066+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:33:01.286+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:33:01.293+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:33:01.294+05:30  INFO 19436 --- [eduler_Worker-2] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job end...
2026-02-06T11:34:00.002+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job is starting...
2026-02-06T11:34:00.002+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  :  Run Case Batch
2026-02-06T11:34:00.021+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 35
2026-02-06T11:34:00.064+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 35
2026-02-06T11:34:00.068+05:30  WARN 19436 --- [eduler_Worker-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:34:00.068+05:30 ERROR 19436 --- [eduler_Worker-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:34:00.069+05:30 ERROR 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 35
2026-02-06T11:34:00.069+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:34:00.069+05:30 ERROR 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:34:00.090+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:34:00.091+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:34:00.105+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:34:00.106+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:34:00.106+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:34:00.304+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:34:00.321+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:34:00.321+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:34:00.415+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 35 Failed
2026-02-06T11:34:00.421+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 35 Failed","EmailText":"Case Batch ID 35 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:34:00.422+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:34:00.534+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 35 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:34:00.541+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:34:00.541+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Next Batch Id = 36
2026-02-06T11:34:00.736+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Start Create CaUniverseT list in Batch ID 36
2026-02-06T11:34:00.747+05:30  WARN 19436 --- [eduler_Worker-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: null
2026-02-06T11:34:00.748+05:30 ERROR 19436 --- [eduler_Worker-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : Connection string is invalid. Unable to parse.
2026-02-06T11:34:00.749+05:30 ERROR 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  :  Case Batch Processing failed for Batch ID 36
2026-02-06T11:34:00.749+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Could not open JPA EntityManager for transaction
2026-02-06T11:34:00.749+05:30 ERROR 19436 --- [eduler_Worker-3] c.o.f.c.a.service.impl.CaseBatchService  : Exception Trace:

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
        at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
        at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
        at jdk.proxy2/jdk.proxy2.$Proxy164.findClaimDrugTbyId(Unknown Source)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createCaUniverseTList(CaseBatchService.java:215)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCaseEntries(CaseBatchService.java:96)
        at com.optum.fads.caseentrybatch.api.service.impl.CaseBatchService.createBatchCase(CaseBatchService.java:77)
        at com.optum.fads.caseentrybatch.api.job.CaseEntryBatchJob.executeInternal(CaseEntryBatchJob.java:21)
        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:75)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:566)
Caused by: org.hibernate.exception.GenericJDBCException: Unable to acquire JDBC Connection [Connection string is invalid. Unable to parse.] [n/a]
        at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:61)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
        at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:116)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getPhysicalConnection(LogicalConnectionManagedImpl.java:143)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.getConnectionForTransactionManagement(LogicalConnectionManagedImpl.java:273)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.begin(LogicalConnectionManagedImpl.java:281)
        at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.begin(JdbcResourceLocalTransactionCoordinatorImpl.java:232)
        at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:83)
        at org.springframework.orm.jpa.vendor.HibernateJpaDialect.beginTransaction(HibernateJpaDialect.java:176)
        at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:421)
        ... 19 common frames omitted
Caused by: net.snowflake.client.jdbc.SnowflakeSQLException: Connection string is invalid. Unable to parse.
        at net.snowflake.client.jdbc.SnowflakeDriver.connect(SnowflakeDriver.java:224)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:681)
        at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:190)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:155)
        at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:146)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:205)
        at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:169)
        at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
        at org.hibernate.internal.NonContextualJdbcConnectionAccess.obtainConnection(NonContextualJdbcConnectionAccess.java:38)
        at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.acquireConnectionIfNeeded(LogicalConnectionManagedImpl.java:113)
        ... 26 common frames omitted

2026-02-06T11:34:00.772+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:getEmailSpecs SmtpHostName is null, Using Azure Logic App
2026-02-06T11:34:00.773+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:34:00.800+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:34:00.801+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed.  A case management administrator will resolve the batch error and resubmit the batch ID for processing. Once complete, you will receive a successful batch email.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:34:00.801+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:34:00.969+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFU toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:34:00.984+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:34:00.986+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail start

2026-02-06T11:34:00.999+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : emailSubject: Case Batch ID 36 Failed
2026-02-06T11:34:01.000+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : CaseBatchUtil:createJsonInput {"EmailSubject":"Case Batch ID 36 Failed","EmailText":"Case Batch ID 36 failed. See error log: Could not open JPA EntityManager for transaction.","SendTo":"anil.wagh@optum.com"}
2026-02-06T11:34:01.000+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.util.CaseBatchUtil           : sendMailLogicAppPost - use HttpPost to send email
2026-02-06T11:34:01.302+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : saveEmailBatchT Batch Id 36 Notice ID NBFA toEmail anil.wagh@optum.com User ID ca88510043 Email Type Fail
2026-02-06T11:34:01.308+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.a.s.impl.CaseBatchEmailService   : CaseBatchEmailService: postBatchProcessMail end
2026-02-06T11:34:01.308+05:30  INFO 19436 --- [eduler_Worker-3] c.o.f.c.api.job.CaseEntryBatchJob        : Create Batch Case job end...
