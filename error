Run:

git rebase -i HEAD~3


Your editor will open with something like:

pick d46b0b3 CVE-2025-48924, CVE-2025-67735, CVE-2024-35255 fix
pick 1ea97e6 vul fix
pick eeb28d5 removed the secrets


Change only the line with d46b0b3 to edit:

edit d46b0b3 CVE-2025-48924, CVE-2025-67735, CVE-2024-35255 fix
pick 1ea97e6 vul fix
pick eeb28d5 removed the secrets


Save and exit (:wq!).

Git will stop and say something like:

You are now editing commit d46b0b3â€¦

Now do exactly this:

Open the file GitHub flagged:

notepad src/main/resources/application.yml


Go to line 19 and remove the secret.
Replace it with an environment placeholder:

client-secret: ${AZURE_CLIENT_SECRET}


Stage it:

git add src/main/resources/application.yml


Amend that commit:

git commit --amend --no-edit


Continue:

git rebase --continue


If it stops again, just run:

git rebase --continue


until it finishes.

Now verify:

git branch --contains d46b0b3


It should show only:

vulFix48924


and not vulFixSG.
That means your branch is finally clean.

Then push:

git push --force-with-lease


At that point GitHub Push Protection will allow the push, because the secret-containing commit no longer exists in your branch history.
